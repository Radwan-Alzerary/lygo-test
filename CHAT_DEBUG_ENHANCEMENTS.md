# ุชุญุณููุงุช Debug Logging ููุธุงู ุงูุฏุฑุฏุดุฉ

## ุงูุชุงุฑูุฎ: $(date '+%Y-%m-%d %H:%M:%S')

## ูุธุฑุฉ ุนุงูุฉ
ุชู ุฅุถุงูุฉ ูุธุงู ุดุงูู ูุชุณุฌูู Debug logs ูู ุฌููุน ููููุงุช ูุธุงู ุงูุฏุฑุฏุดุฉ ูุชุญุณูู ูุฏุฑุฉ ุงูุชุชุจุน ูุงูุชุดุฎูุต.

---

## ุงูุชุญุณููุงุช ุงููุถุงูุฉ

### 1. ุฎุฏูุฉ ุงูุฏุฑุฏุดุฉ ุงูุฃุณุงุณูุฉ (ChatService.js)
**ุงููููุน**: `services/chatService.js`

#### ุงูููุฒุงุช ุงููุถุงูุฉ:
- **ูุนุฑู ุชุชุจุน ูุฑูุฏ**: ูู ุฑุณุงูุฉ ุชุญุตู ุนูู `debugId` ูุฑูุฏ ูุณูููุฉ ุงูุชุชุจุน
- **ููุงุณ ุงูููุช**: ุชุณุฌูู ุงูููุช ุงููุณุชุบุฑู ููุนุงูุฌุฉ ูู ุฑุณุงูุฉ
- **ุชูุงุตูู ุงูุชุญูู**: ุชุณุฌูู ุชูุงุตูู ูุงููุฉ ูุนูููุงุช ุงูุชุญูู ูู ุงูุตูุงุญูุงุช
- **ุญุงูุฉ Redis**: ุชุณุฌูู ุญุงูุฉ ุงูุชุฎุฒูู ุงููุคูุช
- **ูุนูููุงุช ุงูุฃุฎุทุงุก ุงูุดุงููุฉ**: ุชุณุฌูู ููุตู ููุฃุฎุทุงุก ูุน ุงูุณูุงู

#### ูุซุงู ุนูู ุงููุฎุฑุฌุงุช:
```log
[ChatService] [msg_1640123456789_abc123] Starting message processing
[ChatService] [msg_1640123456789_abc123] Rate limit check - senderId: 507f1f77bcf86cd799439011, passed: true
[ChatService] [msg_1640123456789_abc123] Authorization check - isAuthorized: true
[ChatService] [msg_1640123456789_abc123] Message saved successfully - messageId: 507f1f77bcf86cd799439012, processingTime: 45ms
```

### 2. ุฎุฏูุฉ Socket ูููุงุจุชู (CaptainSocketService.js)
**ุงููููุน**: `services/captainSocketService.js` - ุฏุงูุฉ `handleSendChatMessage`

#### ุงูููุฒุงุช ุงููุถุงูุฉ:
- **ุชุชุจุน ุงูุทูุจุงุช**: ุชุณุฌูู ูู ุทูุจ ุฅุฑุณุงู ุฑุณุงูุฉ ูู ุงููุงุจุชู
- **ุญุงูุฉ ุงูุงุชุตุงู**: ุชุญูู ูู ุญุงูุฉ ุงุชุตุงู ุงูุนููู
- **ุชูููุชุงุช ุงูุชูููุฐ**: ููุงุณ ุงูููุช ููู ุฎุทูุฉ
- **ุฅุดุนุงุฑุงุช Socket**: ุชุชุจุน ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ููุนููุงุก

#### ูุซุงู ุนูู ุงููุฎุฑุฌุงุช:
```log
[CaptainSocket] [captain_msg_1640123456789_xyz789] Captain sending chat message - captainId: 507f1f77bcf86cd799439013
[CaptainSocket] [captain_msg_1640123456789_xyz789] Message saved via chat service - messageId: 507f1f77bcf86cd799439014
[CaptainSocket] [captain_msg_1640123456789_xyz789] Message sent to customer socket - customerSocketId: socket_abc123
```

### 3. ุฎุฏูุฉ Socket ููุนููู (CustomerSocketService.js)
**ุงููููุน**: `services/customerSocketService.js` - ุฏุงูุฉ `handleSendChatMessage`

#### ุงูููุฒุงุช ุงููุถุงูุฉ:
- **ุชุชุจุน ุงูุทูุจุงุช**: ุชุณุฌูู ูู ุทูุจ ุฅุฑุณุงู ุฑุณุงูุฉ ูู ุงูุนููู
- **ุญุงูุฉ ุงูุงุชุตุงู**: ุชุญูู ูู ุญุงูุฉ ุงุชุตุงู ุงููุงุจุชู
- **ุชูููุชุงุช ุงูุชูููุฐ**: ููุงุณ ุงูููุช ููู ุฎุทูุฉ
- **ุฅุดุนุงุฑุงุช Socket**: ุชุชุจุน ุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช ูููุงุจุชู

#### ูุซุงู ุนูู ุงููุฎุฑุฌุงุช:
```log
[CustomerSocket] [customer_msg_1640123456789_def456] Customer sending chat message - customerId: 507f1f77bcf86cd799439015
[CustomerSocket] [customer_msg_1640123456789_def456] Message saved via chat service - messageId: 507f1f77bcf86cd799439016
[CustomerSocket] [customer_msg_1640123456789_def456] Message sent to driver socket - driverSocketId: socket_def456
```

---

## ุชุญุณููุงุช ุงูุฃุฏุงุก ูุงููุฑุงูุจุฉ

### 1. ููุงุณ ุงูุฃุฏุงุก
- ุชุณุฌูู ุงูููุช ุงููุณุชุบุฑู ููู ุนูููุฉ
- ูุฑุงูุจุฉ ุงูุงุฎุชูุงูุงุช ุงููุญุชููุฉ
- ุชุชุจุน ูุนุฏู ุงูุฅุฑุณุงู

### 2. ุชุชุจุน ุงูุฃุฎุทุงุก
- ุณูุงู ุดุงูู ููุฃุฎุทุงุก
- ูุนุฑูุงุช ูุฑูุฏุฉ ูุณูููุฉ ุงูุชุชุจุน
- ุชุณุฌูู Stack traces ูุงููุฉ

### 3. ูุฑุงูุจุฉ ุงูุงุชุตุงูุงุช
- ุชุญูู ูู ุญุงูุฉ Socket connections
- ุชุชุจุน ุญุงูุฉ online/offline ูููุณุชุฎุฏููู
- ุฅุญุตุงุฆูุงุช ุงูุชุณููู ุงููุงุฌุญ

---

## ููููุฉ ุงุณุชุฎุฏุงู Debug Logs

### 1. ุชุดุบูู ูุถุน Debug
```bash
# ุชุดุบูู ุงูุฎุงุฏู ูุน ูุณุชูู debug
NODE_ENV=development node main.js
```

### 2. ููุชุฑุฉ ุงูููุฌุงุช
```bash
# ููุชุฑุฉ ุฑุณุงุฆู ุงูุฏุฑุฏุดุฉ ููุท
tail -f app.log | grep "\[ChatService\]\|\[CaptainSocket\]\|\[CustomerSocket\]"

# ุชุชุจุน ุฑุณุงูุฉ ูุญุฏุฏุฉ
tail -f app.log | grep "msg_1640123456789_abc123"
```

### 3. ูุฑุงูุจุฉ ุงูุฃุฏุงุก
```bash
# ูุฑุงูุจุฉ ุฃููุงุช ุงููุนุงูุฌุฉ
tail -f app.log | grep "processingTime\|totalTime"
```

---

## ูุนุงููุฑ ุงูุฃูุงู

### 1. ุญูุงูุฉ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
- ูุง ูุชู ุชุณุฌูู ูุญุชูู ุงูุฑุณุงุฆู ุงููุงูู
- ุชุณุฌูู ุฃุทูุงู ุงููุตูุต ููุท
- ุฅุฎูุงุก ูุนูููุงุช ุงููุณุชุฎุฏููู ุงูุญุณุงุณุฉ

### 2. ุญุฏูุฏ ุงูุชุณุฌูู
- ุชุฌูุจ ุงูุฅูุฑุงุท ูู ุงูุชุณุฌูู
- ูุณุชููุงุช ูุฎุชููุฉ ููุจูุฆุงุช (dev/prod)
- ุชูุธูู ุงูููุฌุงุช ุงููุฏููุฉ ุชููุงุฆูุงู

---

## ุงูุชูุตูุงุช ููุชุดุบูู

### ูู ุจูุฆุฉ ุงูุชุทููุฑ:
```javascript
// ูู config.js
const config = {
  logging: {
    level: 'debug',
    chatDebug: true
  }
}
```

### ูู ุจูุฆุฉ ุงูุฅูุชุงุฌ:
```javascript
// ูู config.js
const config = {
  logging: {
    level: 'info',
    chatDebug: false  // ุชูููู ุงูุชุณุฌูู ูู ุงูุฅูุชุงุฌ
  }
}
```

---

## ุงูุฎุทูุงุช ุงูุชุงููุฉ ุงูููุชุฑุญุฉ

1. **Dashboard ูููุฑุงูุจุฉ**: ุฅูุดุงุก ูุงุฌูุฉ ููุฑุงูุจุฉ ุฅุญุตุงุฆูุงุช ุงูุฏุฑุฏุดุฉ
2. **ุชูุจููุงุช ุชููุงุฆูุฉ**: ุชูุจููุงุช ุนูุฏ ูุดู ุชุณููู ุงูุฑุณุงุฆู
3. **ุชุญูููุงุช ุงูุฃุฏุงุก**: ุชูุงุฑูุฑ ุฏูุฑูุฉ ุนู ุฃุฏุงุก ุงููุธุงู
4. **ุฃุฑุดูุฉ ุงูููุฌุงุช**: ูุธุงู ุฃุฑุดูุฉ ูููุฌุงุช ุงููุฏููุฉ

---

## ููุงุญุธุงุช ูููุฉ

โ๏ธ **ุชุญุฐูุฑ**: ูุฐู ุงูุชุญุณููุงุช ุชุฒูุฏ ูู ุญุฌู ูููุงุช ุงูููุฌุงุช. ุชุฃูุฏ ูู ูุฌูุฏ ูุณุงุญุฉ ูุงููุฉ ุนูู ุงููุฑุต ุงูุตูุจ.

โ **ูุงุฆุฏุฉ**: ุณุชุณูู ูุฐู ุงูููุฌุงุช ูุซูุฑุงู ูู ุนูููุฉ ุชุดุฎูุต ูุดุงูู ุงูุฏุฑุฏุดุฉ ูุชุญุณูู ุงูุฃุฏุงุก.

๐ **ูููุทูุฑูู**: ุงุณุชุฎุฏู ูุนุฑู ุงูุชุชุจุน ุงููุฑูุฏ (`debugId`) ูุชุชุจุน ูุณุงุฑ ุฑุณุงูุฉ ูุนููุฉ ุนุจุฑ ุฌููุน ุงูููููุงุช.
